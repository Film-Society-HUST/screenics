#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import argparse
import sys
import re
import subprocess
import uuid
import shutil
from datetime import datetime, timedelta, timezone
from zoneinfo import ZoneInfo

# --- 全局默认设置 ---
ORGANIZER_NAME = "华科影协"
DEFAULT_LOCATION = "博士生之家"
GITHUB_REPO = "Film-Society-HUST/screenics"
TIMEZONE = ZoneInfo("Asia/Shanghai")

def show_help_string():
    """返回帮助说明文本"""
    return """
=============================================================================

功能描述:
  为华中科技大学电影放映活动生成 .ics 日历文件。支持两种模式：
  1. 命令行模式: 通过参数快速生成文件。
  2. 交互模式: 无参数运行时，引导用户输入信息。

核心功能:
  - 自动根据“开始时间”和“电影时长”计算出结束时间。
  - "智能"计算即将到来的指定星期几的日期。
  - 所有时间均以北京时间 (Asia/Shanghai) 为准

-----------------------------------------------------------------------------
命令行模式用法:
-----------------------------------------------------------------------------
  语法:
    screenics "电影名称" 开始时间 电影时长 周几 [--location "可选地址"]

  参数说明:
  1. movie_title:  字符串。如果名称包含空格，请务必使用双引号 "" 括起来。
  2. start_time:   字符串, 格式为 HH:MM (例如 19:30)。
  3. duration_min: 数字, 单位为分钟 (例如 125)。
 
